<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Example</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            text-align: center;
        }
        h1 {
            color: #333;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            text-transform: uppercase;
        }
        button:hover {
            background-color: #45a049;
        }
        #result {
            margin-top: 20px;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <h1>กรุณากรอกข้อมูล</h1>
    <div id="formContainer">
        <!-- ตำแหน่งที่จะใส่ฟอร์ม -->
    </div>
    <button onclick="addNewForm()">เริ่มต้นใหม่</button>
    <button type="button" onclick="calculateTotalAge()">คำนวณอายุรวม</button>
    <button type="button" onclick="calculateAverageAge()">คำนวณอายุเฉลี่ย</button>
    <button type="button" onclick="findMinAgePerson()">คำนวณชื่อคนที่มีอายุน้อยที่สุด</button>
    <button type="button" onclick="findMaxAgePerson()">คำนวณชื่อคนที่มีอายุมากที่สุด</button>

    <div id="result"></div>

    <script>
        var formCounter = 0;

        function generateRandomNumber() {
            return Math.floor(Math.random() * 9) + 1;
        }

        function addNewForm() {
            var formContainer = document.getElementById("formContainer");
            formContainer.innerHTML = ''; // ล้างความสะอาดของ div

            var numberOfForms = generateRandomNumber();
            for (var i = 0; i < numberOfForms; i++) {
                var form = document.createElement("form");
                form.id = "form" + (i + 1);

                form.innerHTML = `
                    <h2>ฟอร์มที่ ${i + 1}</h2>
                    <label for="name${i}">ชื่อ:</label>
                    <input type="text" id="name${i}" name="name${i}" required><br><br>
                    
                    <label for="age${i}">อายุ:</label>
                    <input type="number" id="age${i}" name="age${i}" min="1" max="150" required><br><br>
                `;

                formContainer.appendChild(form);
                formCounter++;
            }
        }

        function isFormValid(age, name) {
            return !isNaN(age) && name.trim() !== '';
        }

        function checkFormsCompletion() {
            for (var i = 0; i < formCounter; i++) {
                var ageInput = document.getElementById("age" + i);
                var nameInput = document.getElementById("name" + i);

                if (ageInput && nameInput) {
                    var age = parseInt(ageInput.value);
                    var name = nameInput.value;

                    if (!isFormValid(age, name)) {
                        return false;
                    }
                }
            }
            return true;
        }

        function calculateTotalAge() {
            var allFormsCompleted = checkFormsCompletion();
            if (!allFormsCompleted) {
                alert("กรุณากรอกข้อมูลให้ครบถ้วนในทุกฟอร์ม");
                return;
            }

            var totalAge = 0;

            for (var i = 0; i < formCounter; i++) {
                var ageInput = document.getElementById("age" + i);

                if (ageInput) {
                    var age = parseInt(ageInput.value);
                    totalAge += age;
                }
            }

            displayResult("อายุรวม", totalAge);
        }

        function calculateAverageAge() {
            var allFormsCompleted = checkFormsCompletion();
            if (!allFormsCompleted) {
                alert("กรุณากรอกข้อมูลให้ครบถ้วนในทุกฟอร์ม");
                return;
            }

            var totalAge = 0;
            var numberOfPeople = 0;

            for (var i = 0; i < formCounter; i++) {
                var ageInput = document.getElementById("age" + i);

                if (ageInput) {
                    var age = parseInt(ageInput.value);
                    totalAge += age;
                    numberOfPeople++;
                }
            }

            var averageAge = totalAge / numberOfPeople;
            displayResult("อายุเฉลี่ย", averageAge);
        }

        function findMinAgePerson() {
            var allFormsCompleted = checkFormsCompletion();
            if (!allFormsCompleted) {
                alert("กรุณากรอกข้อมูลให้ครบถ้วนในทุกฟอร์ม");
                return;
            }

            var minAge = Infinity;
            var minNames = [];

            for (var i = 0; i < formCounter; i++) {
                var ageInput = document.getElementById("age" + i);
                var nameInput = document.getElementById("name" + i);

                if (ageInput && nameInput) {
                    var age = parseInt(ageInput.value);
                    var name = nameInput.value;

                    if (age < minAge) {
                        minAge = age;
                        minNames = [name];
                    } else if (age === minAge) {
                        minNames.push(name);
                    }
                }
            }

            displayResult("ชื่อคนที่มีอายุน้อยที่สุด", minNames.join(", ") + ", อายุ " + minAge + " ปี");
        }

        function findMaxAgePerson() {
            var allFormsCompleted = checkFormsCompletion();
            if (!allFormsCompleted) {
                alert("กรุณากรอกข้อมูลให้ครบถ้วนในทุกฟอร์ม");
                return;
            }

            var maxAge = -Infinity;
            var maxNames = [];

            for (var i = 0; i < formCounter; i++) {
                var ageInput = document.getElementById("age" + i);
                var nameInput = document.getElementById("name" + i);

                if (ageInput && nameInput) {
                    var age = parseInt(ageInput.value);
                    var name = nameInput.value;

                    if (age > maxAge) {
                        maxAge = age;
                        maxNames = [name];
                    } else if (age === maxAge) {
                        maxNames.push(name);
                    }
                }
            }

            displayResult("ชื่อคนที่มีอายุมากที่สุด", maxNames.join(", ") + ", อายุ " + maxAge + " ปี");
        }

        function displayResult(label, value) {
            var resultDiv = document.getElementById("result");
            resultDiv.innerHTML = `<h2>${label}</h2><p>${value}</p>`;
        }
    </script>
</body>
</html>
