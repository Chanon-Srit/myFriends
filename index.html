<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Example</title>
</head>
<body>
    <h1>กรุณากรอกข้อมูล</h1>
    <div id="formContainer">
        <!-- ตำแหน่งที่จะใส่ฟอร์ม -->
    </div>
    <button onclick="addNewForm()">เริ่มต้นใหม่</button>
    <button type="button" onclick="calculateTotalAge()">คำนวณอายุรวม</button>
    <button type="button" onclick="calculateAverageAge()">คำนวณอายุเฉลี่ย</button>

    <div id="result"></div>

    <script>
        var formCounter = 0;

        function generateRandomNumber() {
            return Math.floor(Math.random() * 9) + 1;
        }

        function addNewForm() {
            var formContainer = document.getElementById("formContainer");
            formContainer.innerHTML = ''; // ล้างความสะอาดของ div

            var numberOfForms = generateRandomNumber();
            for (var i = 0; i < numberOfForms; i++) {
                var form = document.createElement("form");
                form.id = "form" + (i + 1);

                form.innerHTML = `
                    <h2>ฟอร์มที่ ${i + 1}</h2>
                    <label for="name${i}">ชื่อ:</label>
                    <input type="text" id="name${i}" name="name${i}" required><br><br>
                    
                    <label for="age${i}">อายุ:</label>
                    <input type="number" id="age${i}" name="age${i}" min="1" max="150" required><br><br>
                `;

                formContainer.appendChild(form);
                formCounter++;
            }
        }

        function calculateTotalAge() {
            var totalAge = 0;

            for (var i = 0; i < formCounter; i++) {
                var ageInput = document.getElementById("age" + i);

                if (ageInput) {
                    var age = parseInt(ageInput.value);

                    if (!isNaN(age)) {
                        totalAge += age;
                    }
                }
            }

            displayResult("อายุรวม", totalAge);
        }

        function calculateAverageAge() {
            var totalAge = 0;
            var numberOfPeople = 0;

            for (var i = 0; i < formCounter; i++) {
                var ageInput = document.getElementById("age" + i);

                if (ageInput) {
                    var age = parseInt(ageInput.value);

                    if (!isNaN(age)) {
                        totalAge += age;
                        numberOfPeople++;
                    }
                }
            }

            var averageAge = totalAge / numberOfPeople;
            displayResult("อายุเฉลี่ย", averageAge);
        }

        function displayResult(label, value) {
            var resultDiv = document.getElementById("result");
            resultDiv.innerHTML = `<h2>${label}</h2><p>${value}</p>`;
        }
    </script>
</body>
</html>
